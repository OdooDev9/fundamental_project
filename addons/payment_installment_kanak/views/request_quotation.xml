<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- Inherit Form View to Modify it -->
    <record id="req_quotation_view_form_installment" model="ir.ui.view">
        <field name="name">Request Quotation Installment</field>
        <field name="model">request.quotation</field>
        <field name="inherit_id" ref="request_quotation.req_quotation_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='bu_br_user_approve']" position="after">
                <button name="action_installment_modify" string="Modify Installment"
                        type="object" attrs="{'invisible':[('state','!=','draft')]}"/>
            </xpath>
            <xpath expr="//field[@name='unit_or_part']" position="after">
                <field name="installment_plan_id"/>
            </xpath>
            <xpath expr="//page[@name='quotation_lines']" position="after">
                <page string="Installments" name="installments">
                    <group col="3">
                        <group>
                            <field name="tenure_amount_untaxed"/>
                            <field name="tenure_amount_tax"/>
                            <field name="tenure_amt"/>
                            <label for="tenure"/>
                            <div class="o_row" name="Tenure">
                                <field name="tenure" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="tenure_type" nolabel="1"
                                       attrs="{'readonly':[('state','!=','draft')]}" class="oe_inline"
                                       style="margin-left:5px"/>
                            </div>
                            <label for="fine_threshold"/>
                            <div class="o_row" name="fine_threshold">
                                <field name="fine_threshold" attrs="{'readonly':[('state','!=','draft')]}"
                                       class="oe_inline"/>
                                <span>Days</span>
                            </div>

                        </group>
                        <group>
                            <field name="payment_circle_count"/>
                            <field name="down_payment_type"/>
                            <field name="down_payment_percent" attrs="{'invisible':[('down_payment_type','=','fix')]}"
                            />
                            <field name="down_payment_fixed" attrs="{'invisible':[('down_payment_type','=','percent')]}"
                            />
                            <field name="down_payment_amt"/>
                        </group>
                        <group>
                            <field name="payable_amt"/>
                            <field name="installment_amt"/>
                            <field name="interest_rate" attrs="{'readonly':[('state','!=','draft')]}"/>
                            <field name="fine_rate" attrs="{'readonly':[('state','!=','draft')]}"/>
                            <field name="start_invoice_date"/>
                            <field name="contract_date"/>
                        </group>
                    </group>
                    <field name="installment_ids">
                        <tree editable="bottom" string="Installments" create="0" delete="0">
                            <field name="index" optional="hide"/>
                            <field name="payment_date" string="Due Date" optional="show"/>
                            <field name="description" string="Particular" optional="show"/>

                            <field name="interest_rate" string="Rate"/>
                            <field name="total_remaining_amount" string="Principal Beginning" optional="show"/>
                            <field name="without_interest_amount" sum="Total Principle Amount" string="Principal Amount"
                                   optional="show" widget="monetary"/>
                            <field name="interest_amount" sum="Total Interest Amount" optional="show"/>
                            <field name="each_period_ar_amount" sum="Total Ar Amount"
                                   string="Principal Balance" optional="show"/>
                            <!--                            <field name="due_amount" sum="Total Due Amount"/>-->
                            <!--                            <field name="fine_rate" optional="hide"/>-->
                            <!--                            <field name="fine_current_period" sum="Fine Current Period" readonly="0"/>-->
                            <!--                            <field name="fine_previous_period" sum="Fine Previous Period" readonly="0"/>-->
                            <!--                            <field name="fine_amount" sum="Total Fine Amount" string="Total Fine"-->
                            <!--                                   optional="show"/>-->
                            <!--                            <field name="fine_discount" sum="Total Fine Discount" string="Fine Discount"-->
                            <!--                                   optional="show"/>-->
                            <!--                            <field name="interest_discount" sum="Total Interest Discount"-->
                            <!--                                   string="Interest Discount" optional="show"/>-->
                            <field name="amount" sum="Total Amount"/>
                            <!--                            <field name="rv_date"/>-->
                            <!--                            <field name="rv_no"/>-->
                            <!--                            <field name="paid_amount" sum="Total Paid Amount"/>-->
                            <!--                            <field name="fine_paid" sum="Total Fine Paid"/>-->
                            <!--                            <field name="principal_paid" sum="Total Principal Paid"/>-->
                            <!--                            <field name="ar_balance_previous" invisible="1"/>-->
                            <!--                            <field name="ar_balance" sum="Total AR Balance"/>-->
                            <!--                            <field name="state"/>-->
                        </tree>
                    </field>
                </page>
            </xpath>

        </field>
    </record>
</odoo>