<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
		<record id="account_move_inherited_orm" model="ir.ui.view">
			<field name="name">account.move.form.view.inherited</field>
			<field name="model">account.move</field>
			<field name="inherit_id" ref="account.view_move_form" />
			<field name="arch" type="xml">
				<xpath expr="//field[@name='to_check']" position="after">
					<field name="is_oversea_purchase" attrs="{'invisible': [('move_type', 'not in', ['in_invoice','in_refund'])]}" />
					<field name="broker_bill" readonly="1" invisible="1"/>
				</xpath>
				<xpath expr="//field[@name='invoice_date']" position="replace">
					<field name="invoice_date" nolabel="1" options="{'datepicker': {'warn_future': true}}" attrs="{'invisible': [('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))],'required': [('move_type', 'in', ('in_invoice'))]}" />
				</xpath>
				<!-- <xpath expr="//field[@name='partner_id']" position="attributes">
					<attribute name="attrs">{'required': [('move_type', '=', 'in_invoice')]}</attribute>
                    
                </xpath> -->
                <field name="hr_br_id" position="attributes">
                    <attribute name="attrs">{'invisible': [('move_type', 'in', ['in_invoice','in_refund']),('broker_bill','=',False)], 'readonly': [('state', '=', 'posted')]}</attribute>
                </field>
				<xpath expr="//button[@name='action_register_payment']" position="replace">                
					<button name="action_register_payment" id="account_invoice_payment_btn"
							type="object" class="oe_highlight" attrs="{'invisible': ['|', '|','|','|',('broker_bill','=',True),('is_oversea_purchase','=',True),('state', '!=', 'posted'), ('payment_state', 'not in', ('not_paid', 'partial')), ('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))]}"
							context="{'dont_redirect_to_payments': True}"
							string="Register Payment" data-hotkey="g"
							groups="account.group_account_invoice"/>
					<button name="action_register_payment" id="account_invoice_payment_btn"
							type="object" class="oe_highlight" attrs="{'invisible': ['|', '|','|','|',('broker_bill','=',True),('is_oversea_purchase','=',False),('state', '!=', 'posted'), ('payment_state', 'not in', ('not_paid', 'partial')), ('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))]}"
							context="{'dont_redirect_to_payments': True}"
							string="Register Payment" data-hotkey="g"
							groups="master_data_extension.group_cfd_user"/>

					<button name="action_register_payment" id="account_invoice_payment_btn"
							type="object" class="oe_highlight"
							attrs="{'invisible': ['|', '|','|',('broker_bill','=',False),('state', '!=', 'posted'), ('payment_state', 'not in', ('not_paid', 'partial')), ('move_type', 'not in', ('in_invoice', 'in_refund', 'in_receipt'))]}" context="{'dont_redirect_to_payments': True}" string="Register Payment" data-hotkey="g" groups="master_data_extension.group_cfd_user"/>
					</xpath>



			</field>
		</record>
	</data>
</odoo>
