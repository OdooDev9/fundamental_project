<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- 
            Account Move Rules XMLID

            account.account_move_comp_rule 
            account.account_invoice_rule_portal 
            account.account_move_rule_group_readonly 
            account.account_move_rule_group_invoice 
            sale.account_invoice_rule_see_personal 
            sale.account_invoice_rule_see_all 
            purchase.purchase_user_account_move_rule

        -->

        <!-- 
            Account Move Line Rules XMLID

            account.account_move_line_comp_rule 
            account.account_invoice_line_rule_portal 
            account.account_move_line_rule_group_readonly 
            account.account_move_line_rule_group_invoice 
            sale.account_invoice_line_rule_see_personal 
            sale.account_invoice_line_rule_see_all 
            purchase.purchase_user_account_move_line_rule

        -->

        <!-- ACCOUNT MOVE: MOVE LINE -->
        <function name="write" model="ir.model.data">
            <function name="search" model="ir.model.data">
                <value eval="[('module', 'in', ['account','sale','purchase']), ('name', 'in', [
                    'account_move_comp_rule',
                    'account_invoice_rule_portal',
                    'account_move_rule_group_readonly',
                    'account_move_rule_group_invoice',
                    'account_invoice_rule_see_personal',
                    'account_invoice_rule_see_all',
                    'purchase_user_account_move_rule',
                    'account_move_line_comp_rule',
                    'account_invoice_line_rule_portal',
                    'account_move_line_rule_group_readonly',
                    'account_move_line_rule_group_invoice',
                    'account_invoice_line_rule_see_personal',
                    'account_invoice_line_rule_see_all',
                    'purchase_user_account_move_line_rule'
                ])]"/>
            </function>
            <value eval="{'noupdate': False}"/>
        </function>

        <!-- Update Move Origin Rules -->
        <!-- Account Move -->
        <record id="account.account_move_comp_rule" model="ir.rule">
            <field name="domain_force">['|',('journal_id.bu_br_id', '=',user.current_bu_br_id.id),('company_id','=',False),('company_id', 'in', company_ids)]</field>
        </record>
        <record id="account.account_invoice_rule_portal" model="ir.rule">
            <field name="domain_force">['|',('journal_id.bu_br_id', '=',user.current_bu_br_id.id),('move_type', 'in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund')), ('message_partner_ids','child_of',[user.commercial_partner_id.id])]</field>
        </record>
        <record id="account.account_move_rule_group_readonly" model="ir.rule">
            <field name="domain_force">[('journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>
        <record id="account.account_move_rule_group_invoice" model="ir.rule">
            <field name="domain_force">[('journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>
        <!-- Sale Order -->
        <record id="sale.account_invoice_rule_see_personal" model="ir.rule">
            <field name="domain_force">[('move_type', 'in', ('out_invoice', 'out_refund')), ('journal_id.bu_br_id', '=',user.current_bu_br_id.id), '|', ('invoice_user_id', '=', user.id), ('invoice_user_id', '=', False)]</field>
        </record>
        <record id="sale.account_invoice_rule_see_all" model="ir.rule">
            <field name="domain_force">[('move_type', 'in', ('out_invoice', 'out_refund')),('journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>
        <record id="purchase.purchase_user_account_move_rule" model="ir.rule">
            <field name="domain_force">[('move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt')),'|',('hr_br_id', '=',user.current_bu_br_id.id),('hr_bu_id', '=',user.current_bu_br_id.id)]</field>
        </record>

        <!-- Update Move Line Origin Rules -->
        
        <!-- Account Move Line-->
        <record id="account.account_move_line_comp_rule" model="ir.rule">
            <field name="domain_force">['|',('company_id','=',False),('company_id', 'in', company_ids),'|',('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id),('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>
        <record id="account.account_invoice_line_rule_portal" model="ir.rule">
            <field name="domain_force">['|',('move_id.move_type', 'in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund')), ('move_id.message_partner_ids','child_of',[user.commercial_partner_id.id]), ('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id),('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>
        <record id="account.account_move_line_rule_group_readonly" model="ir.rule">
            <field name="domain_force">['|', ('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id), ('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>
        <record id="account.account_move_line_rule_group_invoice" model="ir.rule">
            <field name="domain_force">['|', ('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id), ('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>

        <!-- Sale Order Line-->
        <record id="sale.account_invoice_line_rule_see_personal" model="ir.rule">
            <field name="domain_force">['|',('move_id.move_type', 'in', ('out_invoice', 'out_refund')), '|', ('move_id.invoice_user_id', '=', user.id), ('move_id.invoice_user_id', '=', False),('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id),('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>
        <record id="sale.account_invoice_line_rule_see_all" model="ir.rule">
            <field name="domain_force">['|',('move_id.move_type', 'in', ('out_invoice', 'out_refund')),('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id),('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>

        <record id="purchase.purchase_user_account_move_line_rule" model="ir.rule">
            <field name="domain_force">['|',('move_id.move_type', 'in', ('in_invoice', 'in_refund', 'in_receipt')),('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id),('move_id.journal_id.bu_br_id', '=',user.current_bu_br_id.id)]</field>
        </record>

    </data>
</odoo>
