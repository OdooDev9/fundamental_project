<odoo>
    <data>

        <record id="bu/br_view_move_line_form" model="ir.ui.view">
            <field name="name">account.move.line.form</field>
            <field name="model">account.move.line</field>
            <field name="inherit_id" ref="account.view_move_line_form"/>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="hr_br_id" options="{'no_create_edit': True}" invisible="1"/>
                    <field name="hr_bu_id" options="{'no_create_edit': True}" invisible="1"/>

                </xpath>
            </field>
        </record>

        <record id="view_account_move_bu/br_filter" model="ir.ui.view">
            <field name="name">account.move.select</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_account_move_filter"/>
            <field name="arch" type="xml">
                <search string="Search Move">
                    <field name="hr_bu_id"/>
                    <filter string="Business Unit" context="{'group_by':'hr_bu_id'}"
                            name="hr_bu_id"/>
                    <field name="hr_br_id"/>
                    <filter string="Branch" context="{'group_by':'hr_br_id'}"
                            name="hr_br_id"/>
                </search>
            </field>
        </record>

        <record id="view_account_hr_bu/br_form" model="ir.ui.view">
            <field name="name">account.move</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='payment_reference']" position="after">
                    <field name="hr_br_id"
                           options="{'no_create': True}" attrs="{'invisible': [('move_type', 'not in', ['out_invoice','out_refund'])]}"/>
                    <field name="hr_bu_id" required="1"
                           options="{'no_create': True}"/>
                    <field name="unit_or_part"/>


                </xpath>
                <xpath expr="//tree/field[@name='account_id']" position="after">
                    <field name="hr_br_id" options="{'no_create': True}"/>
                    <field name="hr_bu_id" options="{'no_create': True}"/>
                    <field name="discount_type" invisible="1"/>
                    <field name="br_dis_value" attrs="{'column_invisible': [('parent.br_discount', '=', False)]}"
                           string="BR Discount" readonly="1"/>
                    <field name="discount_value"
                           attrs="{'column_invisible':[('parent.discount_view', 'not in', 'line_discount')]}"
                           string="Discount" readonly="1"/>
                </xpath>
                <xpath expr="// field[@name='line_ids']/tree/field [@name = 'account_id']" position="before">

                    <field name="hr_br_id" required="1" options="{'no_create_edit': True}"/>
                    <field name="hr_bu_id" required="1" options="{'no_create_edit': True}"/>
                </xpath>
                <xpath expr="//field[@name='narration']" position="before">
                    <group>
                        <field name="discount_type" readonly="1"/>
                        <field name="discount_view" readonly="1"/>
                        <field name="br_discount" attrs="{'invisible':[('discount_view', 'not in', 'line_discount')]}"
                               readonly="1"/>
                        <field name="discount_value"
                               attrs="{'invisible':[('discount_view', 'not in', ['doc_discount'])]}" readonly="1"/>
                    </group>
                </xpath>
                <xpath expr="//field[@name='invoice_user_id']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//group[@id='header_right_group']" position="inside">
                    <field name="invoice_user_id" domain="[('share', '=', False)]"/>
                </xpath>
            </field>
        </record>



        <!-- *********move line list view*************** -->
        <record id="view_move_line_tree_bu/br_inherit" model="ir.ui.view">
            <field name="name">account.move.line.tree</field>
            <field name="model">account.move.line</field>
            <field name="inherit_id" ref="account.view_move_line_tree"/>
            <field eval="100" name="priority"/>
            <field name="arch" type="xml">
                <xpath expr="//tree/field[@name='account_id']" position="after">
                    <field name="hr_br_id" required="1" options="{'no_create_edit': True}"/>
                    <field name="hr_bu_id" required="1" options="{'no_create_edit': True}"/>
                </xpath>
            </field>
        </record>

        <!-- *************move line filter************** -->

        <record id="view_account_move_line_bu/br_filter" model="ir.ui.view">
            <field name="name">account.move.line.search</field>
            <field name="model">account.move.line</field>
            <field name="inherit_id" ref="account.view_account_move_line_filter"/>
            <field name="arch" type="xml">
                <search string="Search Journal Items">
                    <filter string="Business Unit" name="hr_bu_id"/>
                    <filter string="Branch" name="hr_br_id"/>
                    <field name="hr_bu_id"/>

                    <filter string="Business Unit" name="hr_bu_id" domain="[]" context="{'group_by': 'hr_bu_id'}"/>
                    <field name="hr_br_id"/>
                    <filter string="Branch" domain="[]" context="{'group_by':'hr_br_id'}"
                            name="hr_br_id"/>


                </search>
            </field>
        </record>
    </data>
</odoo>
